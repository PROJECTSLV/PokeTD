{% extends "base.html" %}

{% block title %}Pokemon Tower Defense - Game{% endblock %}

{% block body_class %}game-body{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/game.css">
{% endblock %}

{% block content %}
<div class="game-wrapper">
    <!-- Ğ’ĞµÑ€Ñ…Ğ½ÑÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ±Ğ¸Ğ»Ğ¾Ğº -->
    <div class="top-panel mobile-only">
        <div class="game-stats">
            <div class="stat-item">
                <span class="stat-icon">ğŸŒŠ</span>
                <span id="currentWave" class="stat-number">1</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">ğŸ¯</span>
                <span id="pokeballCount" class="stat-number">5</span>
            </div>
            <div class="stat-item">
                <span class="stat-icon">ğŸ’°</span>
                <span id="pokeCoins" class="stat-number">0</span>
            </div>
        </div>

        <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ Ğ¿Ğ°ÑƒĞ·Ñ‹ Ğ¸ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ° Ğ½Ğ° Ğ¼Ğ¾Ğ±Ğ¸Ğ»ĞºĞ°Ñ… -->
        <div class="mobile-controls-top">
            <button id="pauseBtnMobile" class="mobile-btn">
                <span class="btn-icon">â¸ï¸</span>
            </button>
            <button id="quitBtnMobile" class="mobile-btn btn-danger">
                <span class="btn-icon">ğŸ³ï¸</span>
            </button>
        </div>
    </div>

    <!-- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€ Ğ¸Ğ³Ñ€Ñ‹ -->
    <div class="game-main">
        <!-- Ğ›ĞµĞ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (Ğ°Ğ»ÑŒĞ±Ğ¾Ğ¼Ğ½Ğ°Ñ Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ) -->
        <div class="left-panel desktop-only">
            <div class="panel-content">
                <h3>Stats</h3>
                <div class="compact-stats">
                    <div class="compact-stat">
                        <div class="stat-label">Health</div>
                        <div class="stat-bar">
                            <div id="compactHealth" class="bar-fill health-fill"></div>
                        </div>
                    </div>
                    <div class="compact-stat">
                        <div class="stat-label">XP Lv.<span id="compactLevel">1</span></div>
                        <div class="stat-bar">
                            <div id="compactXp" class="bar-fill xp-fill"></div>
                        </div>
                    </div>
                    <div class="compact-numbers">
                        <div class="number-item">
                            <span class="stat-icon">ğŸŒŠ</span>
                            <span id="compactWave">1</span>
                        </div>
                        <div class="number-item">
                            <span class="stat-icon">ğŸ’°</span>
                            <span id="compactCoins">0</span>
                        </div>
                    </div>
                </div>

                <!-- ĞŸĞ¾ĞºĞµĞ±Ğ¾Ğ» Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ½Ğ¾Ğ¿ĞºĞ°Ğ¼Ğ¸ -->
                <div class="pokeball-section-desktop">
                    <button id="openPokeballBtn" class="pokeball-btn-desktop">
                        <img src="/static/images/ui/pokeball.png" alt="Pokeball" class="pokeball-img-desktop">
                        <span class="pokeball-count-desktop" id="pokeballsLeft">5</span>
                    </button>
                </div>

                <!-- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ -->
                <div class="controls">
                    <button id="pauseBtn" class="control-btn">
                        <span class="btn-icon">â¸ï¸</span>
                        <span class="btn-text">Pause</span>
                    </button>
                    <button id="quitBtn" class="control-btn btn-danger">
                        <span class="btn-icon">ğŸ³ï¸</span>
                        <span class="btn-text">Quit</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¿Ğ¾Ğ»Ğµ Ğ¸Ğ³Ñ€Ñ‹ -->
        <div class="game-field">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
        </div>

        <!-- ĞŸÑ€Ğ°Ğ²Ğ°Ñ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (Ğ°Ğ»ÑŒĞ±Ğ¾Ğ¼Ğ½Ğ°Ñ Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ) - Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ ĞºĞ°Ñ€Ñ‚ -->
        <div class="right-panel desktop-only">
            <div class="panel-content">
                <div class="hand-header">
                    <h3>Your Hand</h3>
                    <div class="hand-count" id="handCount">0</div>
                </div>
                <div class="cards-container-vertical" id="handContainer">
                    <div class="empty-hand">
                        <div class="empty-icon">ğŸƒ</div>
                        <p>No cards in hand</p>
                        <p class="hint">Open a pokeball to get Pokemon!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ĞĞ¸Ğ¶Ğ½ÑÑ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ (Ğ¿Ğ¾Ñ€Ñ‚Ñ€ĞµÑ‚Ğ½Ğ°Ñ Ğ¾Ñ€Ğ¸ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ) -->
    <div class="bottom-panel mobile-only">
        <div class="hand-section">
            <div class="hand-header">
                <h4>ğŸ´ Hand</h4>
                <!-- ĞŸĞ¾ĞºĞµĞ±Ğ¾Ğ» Ğ² ÑƒĞ³Ğ»Ñƒ Ğ½Ğ° Ğ¼Ğ¾Ğ±Ğ¸Ğ»ĞºĞ°Ñ… -->
                <div class="pokeball-corner">
                    <button id="openPokeballBtnMobile" class="pokeball-btn-corner">
                        <img src="/static/images/ui/pokeball.png" alt="Pokeball">
                        <span class="count-corner" id="pokeballsLeftMobile">5</span>
                    </button>
                </div>
            </div>
            <div class="mobile-cards" id="handContainerMobile">
                <!-- Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· JS -->
            </div>
        </div>
    </div>
</div>

<!-- ĞœĞ¾Ğ´Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ Ğ¾ĞºĞ½Ğ¾ ĞºĞ¾Ğ½Ñ†Ğ° Ğ¸Ğ³Ñ€Ñ‹ -->
<div class="end-game-modal" id="endGameModal">
    <div class="modal-overlay">
        <div class="modal-content">
            <h2 id="gameResultTitle"></h2>
            <div class="result-stats">
                <div class="result-stat">
                    <span class="stat-icon">ğŸ’°</span>
                    <span class="stat-label">Coins Earned:</span>
                    <span id="finalCoins" class="stat-value">0</span>
                </div>
                <div class="result-stat">
                    <span class="stat-icon">ğŸŒŠ</span>
                    <span class="stat-label">Waves:</span>
                    <span id="finalWaves" class="stat-value">0</span>
                </div>
                <div class="result-stat">
                    <span class="stat-icon">ğŸ‘¾</span>
                    <span class="stat-label">Enemies:</span>
                    <span id="finalEnemies" class="stat-value">0</span>
                </div>
                <div class="result-stat total">
                    <span class="stat-icon">ğŸ’°</span>
                    <span class="stat-label">Total Coins:</span>
                    <span id="totalCoins" class="stat-value">0</span>
                </div>
            </div>
            <div class="modal-buttons">
                <button id="playAgainBtn" class="modal-btn btn-primary">ğŸ”„ Play Again</button>
                <button id="returnToLobbyBtn" class="modal-btn btn-secondary">ğŸ  Lobby</button>
            </div>
        </div>
    </div>
</div>

{% block extra_js %}
<script src="/static/js/game.js"></script>
{% endblock %}
{% endblock %}